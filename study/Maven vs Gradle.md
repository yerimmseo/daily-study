# Maven vs Gradle

1. 빌드 관리 도구란?
    - 프로젝트에서 Java 코드와 프로젝트 내에 필요한 각종 xml, properties, jar 파일들을 JVM이나 WAS가 인식할 수 있도록 패키징 해주는 빌드 과정(빌드 자동화 도구)라고 할 수 있음
    - 프로젝트 생성, 테스트 빌드, 배포 등을 위한 전용 프로그램
    - 개발자들 간에 힘들었던 버전 동기화의 번거로움을 줄여줌
    - 각 라이브러리들을 번거롭게 모두 다운 받을 필요없이, 빌드 도구 설정 파일에 필요한 라이브러리 종류와 버전들, 종속성 정보를 명시하여 필요한 라이브러리들을 설정 파일을 통해 자동으로 다운로드하고 간편히 관리해주는 도구

<br>
    
2. 빌드 툴의 역사
    
    (1) Make
    
    - ‘빌드’ 개념을 확립
    - Unix 계열의 OS에서 사용
    - 이전에 수작업으로 수행했던 빌드 과정을 Makefile이라는 통일된 구조로 처리할 수 있게 함
    
    
    (2) Ant
    
    - 범용성을 높임 (크로스 플랫폼 대응)
        - 크로스 플랫폼: 멀티 플랫폼의 동의어. 컴퓨터 프로그램/운영 체제/컴퓨터 언어/프로그래밍 언어/컴퓨터 소프트웨어 등이 여러 종류의 컴퓨터 플랫폼에서 동작할 수 있다는 것을 뜻함 (대표적인 예: Java)
    - 1990년 Java의 등장
    - Make를 자바에 적용하려다보니 여러가지 문제가 발생, 이를 보완하기 위해 등장 (Make는 C언어로 개발된 S/W를 빌드할 때 아직 사용하고 있음)
    - Java + XML 기술을 도입함으로써 Make의 문제점이었던 플랫폼 의존 문제를 해결
    - 간단하고 사용하기 쉽지만, 약간의 복잡한 처리를 하려고 하면 빌드 스크립트가 장황해져 관리가 어렵다는 단점이 있음
    - 라이브러리 의존 관계를 관리하는 구조가 없음
    
    (3) Maven
    
    - 빌드 스크립트 작성 ‘효율’을 높임
    - 빌드 생명 주기와 프로젝트 객체 모델(POM) 개념을 도입 → Ant의 문제점이었던 장황한 빌드 스크립트 문제를 해결
    - POM에 메타 데이터를 적용하여 라이브러리 의존관계를 자동으로 관리해주는 기능을 구현
    - pom.xml 설정이 길어짐에 따라 가독성이 저하 (한계)
    - 외부 저장소에서 필요한 라이브러리와 플러그인들을 다운로드 한 다음, 로컬 시스템의 캐시에 모두 저장함
    
    (4) Gradle
    
    - 스크립트 언어로 회귀하여 유연성을 증대
    - JVM 위에서 동작하는 Groovy 언어를 사용한 Domain-specific-language를 사용
        - Groovy: 스크립트 언어로서 소스 코드를 그대로 실행 (컴파일 할 필요가 X)
        - 동적인 빌드는 Groovy 스크립트로 플러그인을 호출하거나 직접 코드를 작성하면 됨
        - Maven의 xml 형태보다 가독성 우수
    - Gradle은 프로젝트의 어느 부분이 업데이트 되었는지 알기 때문에 빌드에 점진적으로 추가할 수 있음
        - 업데이트가 이미 반영된 빌드의 부분은 더이상 재실행되지 않음 (빌드 시간이 훨씬 단축될 수 있음)

<br>
        
3. Maven vs Gradle
    - Gradle은 작업 의존성 그래프를 기반으로 하는 반면 Maven은 고정적이고 선형적인 단계의 모덜을 기반으로 함
    - 성능 측면에서는 둘 다 다중 모듈 빌드를 병렬로 실행할 수 있지만, Gradle은 어떤 task가 업데이트 되었고 안되었는지를 체크하기 때문에 incremental build를 허용함
    - Maven의 경우 멀티 프로젝트에서 특정 설정을 다른 모듈에서 사용하려면 상속을 받아야 하지만 Gradle은 설정 주입 방식을 제공함
    - Gradle은 동시적으로 안전한 캐시를 허용
        - 2개 이상의 프로젝트에서 동일한 캐시를 사용할 경우, 서로 overwrite 되지 않도록 checksum 기반의 캐시를 사용하고 캐시를 repository와 동기화시킬 수 있음
    - 고도로 사용자 정의된 빌드를 작성하기 위해서는 커스터마이징이 간편한 Gradle을 사용하는게 훨씬 나음
        
<br>
        
4. 성능 비교

(1) 시나리오: Java 라이브러리

일반적인 라이브러리 프로젝트에 미치는 영향을 측정하기 위해 Apache Commons Lang 3 프로젝트를 Maven에서 Gradle로 변환(Java 라이브러리 플러그인 사용)

![Untitled](https://user-images.githubusercontent.com/80576569/186609459-22df6807-14ce-4492-9ac2-6958f733ff29.png)

Gradle은 테스트를 실행할 때 1.7배 더 빠르고, 빌드 캐시를 사용할 때 최대 30배 더 빠르게 빌드함

<br>

(2) 시나리오: 소규모 다중 프로젝트 빌드

마이크로서비스 모음과 유사한 10개 모듈 다중 프로젝트 빌드에 대해 일반적인 작업에 대한 결과. 각 하위 프로젝트에는 50개의 소스 파일과 50개의 테스트 소스 파일이 있음

![Untitled 1](https://user-images.githubusercontent.com/80576569/186609524-5b9eb6ee-c17c-4187-a7c4-9bc2105aae33.png)


Gradle은 클린 빌드인 경우 2~3배, 증분 변경의 경우 약 7배, Gradle 작업 출력이 캐시될 때 최대 14배 빠름

<br>

(3) 시나리오: 중간 규모의 다중 프로젝트 빌드

단일 저장소에 있는 100개 모듈 다중 프로젝트 빌드에 대한 일반적인 작업의 결과. 각 하위 프로젝트에는 100개의 소스 파일과 100개의 테스트 파일이 있음

![Untitled 2](https://user-images.githubusercontent.com/80576569/186609581-5e0c424f-cb84-4f12-b776-d5ad37cf4544.png)

Gradle은 클린 빌드인 경우 4~5배, 증분 변경의 경우 약 40배, 작업 출력이 캐시될 때 최대 13배 빠름

<br>

(4) 시나리오: 대규모 다중 프로젝트 빌드

단일 저장소에 있는 500개 모듈 다중 프로젝트 빌드에 대한 일반적인 작업의 결과. 각 하위 프로젝트에는 100개의 소스 파일과 100개의 테스트 파일이 있음

![Untitled 3](https://user-images.githubusercontent.com/80576569/186609627-5149dfef-0ffb-44d3-924a-8a4df5ff2e73.png)

Gradle은 클린 빌드의 경우 3~10배, 증분 변경의 경우 약 85배, Gradle 작업 출력이 캐시될 때 최대 13배 빠름

<br>

(5) 시나리오: 대규모 모놀리식 애플리케이션

이 시나리오는 50000개의 소스 파일과 50000개의 테스트 파일이 있는 단일 프로젝트와 같은 프로젝트의 근사치

![Untitled 4](https://user-images.githubusercontent.com/80576569/186609662-b8ae409f-ad9c-46e2-9d50-a84a564d6fec.png)

Gradle은 클린 빌드의 경우 2~3배, 증분 경우의 경우 약 7배, Gradle 작업 출력이 캐시될 때 최대 3배 빠름

<br><br>

** 실적 결과 요약 **

- 모든 결과에서 Gradle은 모든 단일 시나리오에서 최소 2배 더 빠름
- 점진적 변경을 빌드할 때 Gradle은 Maven보다 7~85배 빠름. 혜택은 하위 프로젝트의 수에 따라 증가
- Gradle 빌드는 작업 출력이 Gradle의 빌드 캐시를 확인할 수 있는 경우 Maven 빌드보다 3~30배 빠름

*[참고] Gradle.com: https://gradle.org/gradle-vs-maven-performance*
